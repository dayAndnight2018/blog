---
title: micro-architect-02-模块拆分
date: 2020-06-23 20:40:38
tags: microservice
---

## 模块拆分考虑的因素

1. 系统的复杂度

模块拆分越细，模块越小，数量越多，依赖关系越复杂。

2. 团队协作

模块内部由单个团队负责，需要团队之间协作。

3. 代码维护难度

模块提供的服务发生变动会影响其他模块的调用。

4. 资源分配

模块拆分越细，越能够准确扩展需求高的模块。

## 单模块

模块内部高度内聚，具有独立的内存、数据库、单元测试、业务逻辑等。

<img src='micro-architect-02-module-break\e61cbb64-25a6-4eca-b7e2-19b6fe415c74.jpg'>

大部分请求是同步的，若调用时间过长，可采用消息队列实现异步。消费方将请求发送至服务方消息队列，服务方处理结束后调用发送方的回调地址通知即可。

## 基础模块

对模块进行梳理

<img src='micro-architect-02-module-break\8e9026b4-dd56-4899-bd78-d77ab74743ea.jpg'>

各个模块提供的服务具有原子性，将依赖较少的模块作为基础模块，为复杂的模块服务。

## 复杂模块

当对基础模块进行聚合实现复杂逻辑时，各个基础模块的事务管理较为简单，但多模块之间的二阶事务管理较为复杂。对于无法避免的分布式事务，采用TCC补偿性事务管理方案进行管理。

服务模块尽可能做到无状态，session由redis进行维护。